<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">
<head>
    <title>Alerts</title>
</head>
<body>
<div layout:fragment="content">
    <h2 class="mt-3">Security Alerts</h2>
    <div class="table-responsive">
        <table class="table table-striped table-sm">
            <thead>
            <tr>
                <th>Severity</th>
                <th>Category</th>
                <th>Resource</th>
                <th>Message</th>
                <th>Time</th>
                <th>Status</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="alert : ${alerts}">
                <td>
                    <span th:text="${alert.severity}"
                          th:class="${'badge ' + (alert.severity.name() == 'CRITICAL' ? 'bg-danger' : (alert.severity.name() == 'HIGH' ? 'bg-warning text-dark' : (alert.severity.name() == 'MEDIUM' ? 'bg-info text-dark' : 'bg-secondary')))}">
                    </span>
                </td>
                <td th:text="${alert.category}"></td>
                <td th:text="${alert.resourceType} + ': ' + ${alert.resourceName}"></td>
                <td th:text="${alert.message}"></td>
                <td th:text="${#temporals.format(alert.createdAt, 'yyyy-MM-dd HH:mm:ss')}"></td>
                <td th:text="${alert.status}"></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>
